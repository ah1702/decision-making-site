<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Sleep Cycle Manager</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f8f9fa;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            text-align: center;
        }

        .container {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
            width: 80%;
            max-width: 800px;
        }

        h1 {
            font-size: 2em;
            margin-bottom: 20px;
        }

        input, button {
            padding: 10px;
            font-size: 1em;
            margin: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }

        input[type="time"] {
            width: 120px;
        }

        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }

        button:hover {
            background-color: #45a049;
        }

        canvas {
            margin-top: 30px;
            max-width: 100%;
        }

        .recommendation {
            margin-top: 20px;
            font-size: 1.2em;
            color: #555;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Sleep Cycle Manager</h1>
        <p>Optimize your sleep schedule for better rest and energy!</p>

        <label for="wakeUpTime">Desired Wake-up Time:</label>
        <input type="time" id="wakeUpTime" value="07:00"><br>

        <label for="sleepDuration">Desired Sleep Duration (hours):</label>
        <input type="number" id="sleepDuration" value="8" min="1" max="12"><br>

        <button onclick="generateSleepCycle()">Generate Sleep Cycle</button>

        <div id="recommendation" class="recommendation"></div>

        <div>
            <h2>Your Ideal Sleep Cycle</h2>
            <canvas id="sleepChart"></canvas>
        </div>
    </div>

    <script>
        // Function to generate the sleep cycle graph based on user input
        function generateSleepCycle() {
            const wakeUpTime = document.getElementById('wakeUpTime').value;
            const sleepDuration = parseInt(document.getElementById('sleepDuration').value);

            // Convert wake-up time to minutes since midnight
            const wakeUpHours = parseInt(wakeUpTime.split(":")[0]);
            const wakeUpMinutes = parseInt(wakeUpTime.split(":")[1]);
            const wakeUpInMinutes = wakeUpHours * 60 + wakeUpMinutes;

            // Calculate ideal sleep start time (in minutes)
            const sleepStartInMinutes = (wakeUpInMinutes - sleepDuration * 60 + 1440) % 1440;

            // Generate time labels for the graph (24 hours)
            const labels = Array.from({ length: 24 }, (_, i) => (i % 24) + "h");

            // Generate sinusoidal data for the sleep cycle
            let data = [];
            for (let i = 0; i < 24; i++) {
                let timeInMinutes = i * 60;
                // Create a sinusoidal pattern with a peak at waking time and trough at sleep start
                let sleepCycleValue = Math.sin((Math.PI * (timeInMinutes - sleepStartInMinutes)) / (sleepDuration * 60));
                data.push(sleepCycleValue);
            }

            // Create chart.js graph
            const ctx = document.getElementById('sleepChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Energy Level',
                        data: data,
                        borderColor: '#4CAF50',
                        fill: false,
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Time of Day'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Energy Level'
                            },
                            suggestedMin: -1,
                            suggestedMax: 1
                        }
                    }
                }
            });

            // Display sleep cycle recommendation
            document.getElementById('recommendation').textContent = `To optimize your sleep cycle, try to go to bed around ${formatTime(sleepStartInMinutes)} to wake up feeling refreshed at ${wakeUpTime}.`;

        }

        // Helper function to format time in minutes to HH:MM format
        function formatTime(minutes) {
            let hours = Math.floor(minutes / 60);
            let mins = minutes % 60;
            return `${hours.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}`;
        }
    </script>
</body>

</html>
